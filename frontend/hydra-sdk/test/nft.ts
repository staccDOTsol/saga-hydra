/* eslint-disable @typescript-eslint/no-unused-vars */
import { Connection, Keypair } from '@solana/web3.js';
import {
  NATIVE_MINT,
  ASSOCIATED_TOKEN_PROGRAM_ID,
  Token,
  TOKEN_PROGRAM_ID,
} from '@solana/spl-token';
import { expect, use } from 'chai';
import ChaiAsPromised from 'chai-as-promised';
import {
  Fanout,
  FanoutClient,
  FanoutMembershipMintVoucher,
  FanoutMembershipVoucher,
  FanoutMint,
  MembershipModel,
} from '../src';
import fs from 'fs'
import { LOCALHOST } from '@metaplex-foundation/amman';
import { builtNftFanout } from './utils/scenarios';
import { keypairIdentity, Metaplex, PublicKey } from '@metaplex-foundation/js';
import { Wallet } from '@project-serum/anchor';
let nfts = [{"id":"5c9Eof5TWxUzEj9JnjYssRuXoxV8T6yKhrKGrvfnqb7C","earliest":276},{"id":"5U4eNuQDrd6aY94UD7CxgF5eM96ErDP5tjwQP1iZsPbN","earliest":276},{"id":"Bp7duShangeN1jgWUFqgaGN51kxYgdKm8Dea916dzwDr","earliest":276},{"id":"9VyTdXMBXXPaEcCXjhCqicLF975Ji2zz4SwMSvCYe9ks","earliest":276},{"id":"JCnk1UKA7hPZm8qaFN6M5A9dCYiaSwRK8XtuaFqoQ1Lt","earliest":336},{"id":"JBtuoM2r6YFM1pK5nX2CnVDCUaPtNE6G8dnJjDfXaCau","earliest":325},{"id":"J9bQLmpZoVRPc4aFVGe1kB9Ro2pUoaHnfXGAwcywhFQk","earliest":304},{"id":"J8o51TzY9FPHqhkgjzSyRBZt49LHug7yJCMHcY4AFGYB","earliest":336},{"id":"J7PwM4KxL2iNaRJJDTVRcsVCSMUFo8P3nEZUnEupHwc7","earliest":313},{"id":"J4NTnGdSMRy3t85ABw8FVDFBAFMzWWpcCxgdwtQVzzRy","earliest":321},{"id":"HzYnv3hwEtYJY481rHgo47cecQGeaCMLuU1pP6zrh4iy","earliest":277},{"id":"Hz2vuZkGd5HAGG95eMERAZUyQLEbXLfDtKzMhKHJjT8p","earliest":277},{"id":"HwCGfsFiig3uSssBJ675f8LehngzaHH1Lageek74RUDm","earliest":256},{"id":"HnNH5Nb7JCgWvooRqSdPmwKEEjvkAodD8hDYc2XCPwke","earliest":294},{"id":"HiHdg6Paj4V8N8kJ3jQkXMwZokNomnFAq3Cc6ubLNtZ4","earliest":336},{"id":"Hg3uWisXVYGXx26QjdJ9tTjbhfH95kqe9zPNKm396LE4","earliest":219},{"id":"HWYeVbnRRCKK3qA1fm5JDy2oULpd2Xustz4nUi4wPfcb","earliest":333},{"id":"HU66qf1ZWE5W4KF2WeJ8nzP6jBfwG9zH3pneDvduLdyg","earliest":400},{"id":"HSaG89ZTqh2r3dy4LYkcYq59pyWWBQd7N38wquBHZhxW","earliest":355},{"id":"HQYaKugxvVzktxVghNJcDMs5g4X7wrPsAsaJSXn4kjxc","earliest":313},{"id":"HP27ViWYUiYrVRGhq9rFDwr6QVGZB63YZ9kDUzLhGZqJ","earliest":194},{"id":"HJcQeS75uhKcixRx76kDeuVJ1GqKZf2Yo6L1Mgcpb7op","earliest":398},{"id":"HCUScDT4zPg1WiwJDkKC6KKMebMZuAeH4vCn9WKxFutK","earliest":398},{"id":"HA4fGWFyoCtXuLYSwU3RoaPPT1sDDCiASbDHcC4QMntL","earliest":333},{"id":"H6Rs1uo8HMKQArt1hanAzPNYAKp6nW4iP5SCpzyeZzv3","earliest":409},{"id":"H3bhyRhdV2whBwt9qoPZqptb49mcJAAjDWSiUBAJLVHo","earliest":207},{"id":"H22dYUZ6DZSjzo6d6G8acSqdmrKY6KLS92k7YH4uyzTz","earliest":313},{"id":"GuunkVGxMwnNqu7BWquLHu9a2rHXxGn1JHNPAUvJ8SaV","earliest":343},{"id":"GrA1zhEE9DJ9rFwQ3r3NKEzGUaPaAAvh7Lbu4FafVAv3","earliest":560},{"id":"Gj1K7cmCjQ6uLmxPUogh8X3tX1Tv49PRB2uEEVLfeX1Y","earliest":309},{"id":"Gi4kYJEEef5zUzy3E9VyVeQ6ngwnag7fwVQeKy4EBtBQ","earliest":398},{"id":"Gg2YY7JtmQqwwPXZaFrRXpYj6RjHeBPTGZ3vTmFdKCKS","earliest":355},{"id":"GeUjJ4bPYA2rKTDF3hxUhFfM3Go6VEwVz5Wy6MPNnxfr","earliest":219},{"id":"GeC1SftgjUFJeurd56eiMtUchzQnempL3RejAMP8uWJu","earliest":219},{"id":"GcnirzDm5qQTp3MvhEHAoG6j48yThdvQQckGqBx7jSG3","earliest":256},{"id":"GbEiEc7fzPYzYpAms9cmkDZ7Vpf7mDJz7VcCkHULtmbV","earliest":325},{"id":"GUkagNYr2RW3g3XQj49ZurM3vYTLJjyCHxokqnFDEcJZ","earliest":366},{"id":"GQqFPVS6gbki9Bs3fGCT6KLT12rvPJ9mb8ZRTHWS3mPD","earliest":329},{"id":"GPZpRnHkWP9qWBw6EDsGPpuMPeFefCaDS8VHgTaHHVzD","earliest":263},{"id":"GPMBiNdtTgRuCWJq65hqz28GM2wuYGb14FeaaaAEhaYh","earliest":404},{"id":"GFLmN6FP2hexfSZE94r8cjmwbL7PKUjcDdc7yfXABapM","earliest":325},{"id":"GDpnBHLJ8v6fXhHfatnDcxNFf3ymtw7wN6AxECQQ8ydX","earliest":409},{"id":"G9Y3geoBRLAxGXYXqhPKRfVTgtBkp93vyUwReb3F21MT","earliest":230},{"id":"G8e3bNB1PFcPVgg9xToh6rg7VBSNqsbtuM2otD9FxSp5","earliest":393},{"id":"G86JUK7zYutqB5rSCoFFe2RPz6sp251FG66957mELwav","earliest":207},{"id":"G72j4JLGpM4NqLtF8LEnMW2y6t3jxNvZQ7NMZoDBWeEm","earliest":160},{"id":"G41qt4X4pEb36TiQnTXuGMQ9qZomciPYUZRcpBySXrb5","earliest":400},{"id":"G2cSeKDg2QaVndjgt8fmFuzB67gqpxYqQfLot9xztFFy","earliest":256},{"id":"G2SXRAAc4r8MoEzHrjkAyJwyULXnYKXjGWYLXxakqMMX","earliest":409},{"id":"Ftpj4tk2kydbh2fTD7VL9j7yDATwZzVkkHQ4o4EoLR44","earliest":256},{"id":"FsyrBwXebk7SSXJyNv8iauZfJdMkf6jYXTp6T3HYtzhP","earliest":336},{"id":"FsUL3S2aRDFeQxk2JQ9pDg5WxG2TvVLjMvTubUFCxvKV","earliest":389},{"id":"FrwZxgHTkVgJXfpQBUDQYU3cZQ2kTbFAPC6wZAUxK9h6","earliest":313},{"id":"FrDhX2pmF3rBd4PE53iep95MsuEX6LNKY54iDXf9ZeSV","earliest":263},{"id":"FkGdVBHBv8JmbMHEd5CYfrVXrextQV3ikcSomBaUCsrW","earliest":313},{"id":"Fi7wGrVqwAm4JoRoWUr4CrnVY8exv6czFLpQYVWAJQwZ","earliest":329},{"id":"FhugFXLW5Z5T2NU7jEUm4xGzbfL85CjXNa8BV3yDGKuk","earliest":194},{"id":"FfrPwsxVnpfBgoN5qKkvrQfyKkE41C3DcK2Kv7MzB9d2","earliest":329},{"id":"FcAR4tPKcTFtGJcwnUygsWGxhqLcD3hDB8RGsR8DwsUQ","earliest":363},{"id":"FRzUWQEXjg2iDc3dtBZtG9SXnw9PyZgR776zoqBE1uMU","earliest":277},{"id":"EpzQFra6WTPFXwHXrpg4HJ7drLyPoKvEBdm87jQ7d4yA","earliest":343},{"id":"EQsPuhxYFSRv7BikTq9UdvxnjoKxJnmbxGif7b2dF8tZ","earliest":333},{"id":"EQ2r54ifedLbxXCG33gfN5mqYm83yoSvjmZWcJ2gmbkE","earliest":230},{"id":"EKM6mZAToN2hC6NyBQnHvTraX1YCL3YYew7aBSMfGhNr","earliest":333},{"id":"EJrssn1xXauQF97m89xct6DpeFx32JUwshLoZMVkoHg9","earliest":340},{"id":"EJKF8rVgJthG1K5nCYrRjLN3L9Zx3zQsv77znfx5rdyb","earliest":256},{"id":"EJ5tu9eHQPzVLdYFqV1tfwEYu5kVdPb3Mh28B8qhe2zD","earliest":371},{"id":"EHsDkncwxXg7g51UdssfUo6etBCdbwmoRnSHLN1tLPnt","earliest":333},{"id":"EDzLTLothpMJvSeBRzZxmRqoj3vUhB7thyestmGria5y","earliest":256},{"id":"EC3f4rcL7k2Raz5cr1EbKw3KBYVKd5Fnt9SX7MkbKheB","earliest":333},{"id":"EBvZAqL2pRSGQKtXUpnQwLBciVEkvYhBhahzG3rhtZbQ","earliest":363},{"id":"EBtmMFohjbfKKbhbMQBM7PSvBFSnHAfcz7RVZqM4vzJz","earliest":277},{"id":"E92frVRYJbe2HYwSrQ83CGJaMEZdaaxCRNV5nYAfbFRW","earliest":263},{"id":"E2WJgZoxF5fsTPMoXYL8Qj9ndjCRhGbqbZA6ReKnrToJ","earliest":336},{"id":"E2LsPwM8yiYLWssSraoSZQFyG1mHttdMXkfZVwfrWirR","earliest":263},{"id":"E1iW3ofbCwinMLJoGjMTnheqfLqsVzSqL9RnKTmb1Agi","earliest":333},{"id":"DxYRxqKcQar7aQMYFKCqJ12y6TAyZqYKywBCeheVrqfh","earliest":313},{"id":"DuWqabSAMByQ1LZi89zF1Lsuo8G4MSVrGMAU9Vi3qhDM","earliest":404},{"id":"DtEVGySwiGE44YrZxPU482J34JykwzBojxZ1Awui9h9t","earliest":404},{"id":"Dq6hbPijknWfWWs9odvzZ3gu9b9w3EgM52WFWpJV2FFo","earliest":409},{"id":"Djm2VPrE2PT8fZumBcvxTCuFt8WiMXsQsexymZp2PTw7","earliest":333},{"id":"DfaQtp829M1hmFM5NJFvVAKXq125NMKWVLSAhcyzzCUx","earliest":378},{"id":"DbrZYVBzxV2NwaL7jUSF8xNk7UoNau3aWdCMunFujFT1","earliest":409},{"id":"DTsiWmi6xV6z7LyRd5mGjERKMtG83wKGkQ41ySUpws2e","earliest":543},{"id":"DTGgBewUPCuQFmrHNbjxbpFraBB8sTPi1he3F9MsypPz","earliest":309},{"id":"DT3yF2LPqUimXVBirA8tCgG6rVMUrkVcW4zL2dHyRs5A","earliest":304},{"id":"DSuyCyC3NEqj3G7Vy8WiwgfvkUs4CvuVdJjF9PMhWLyn","earliest":373},{"id":"DSkBMnHZUDMwU8VSsos8rGeQ6sEhT8oz8yTdcvsuMy4W","earliest":263},{"id":"DS7R4xZAeuhdadm7CZ1revPoXnSmBzL4vSLci5RrP9qV","earliest":179},{"id":"DRZSkugKbgN1y52p3ny9DBFpjPrXRsU73o4q5BS5Wowr","earliest":402},{"id":"DQgusWofJtDxuCtqs2eBvrZxraVCQrnkig8UjJb2FPVs","earliest":263},{"id":"DQDp6qGFLcntamv1mLyeyuJmveBvQVMqL3mmqKxf3kUd","earliest":336},{"id":"DNXMXD9U4kAEp5Vo9P9g2cXeAsrc7AaCGB4y8WgVLNbV","earliest":329},{"id":"DHaRzUvNC9fxVjKCJ91XS1iBrXLvm6kKzUMGzjWXh5Mh","earliest":333},{"id":"DFLibLKptLJRY3Sr2zdDuToDP7brvN594qT4avt1Con5","earliest":409},{"id":"DDF5qWW28iSQ7mBrw3qUa92EezN7NUWczf53dL2UsVrW","earliest":194},{"id":"D8Vmm54AZjo41QWNrJobKtYzbiwLFqvnxk7qyS3LAfEt","earliest":333},{"id":"CwV7CUX91Phjxj1tVLmYogb11gp65XR8C5B95mEaoLjp","earliest":239},{"id":"CpEkD2rnHQVGE4BfEcEfUDHywFMXMPyhMaeZvjabs9sA","earliest":407},{"id":"CoW8UKFQLaVHKDmEbLaeQkGLXg3thNjHNAjrrF2QphNx","earliest":333},{"id":"CgN8jeRysm38khn5AovVHReemrjE5QCtVZeEgPQnu8kr","earliest":329},{"id":"Cd1FHUZ2RdZ7D3Zsrazi9UAm4wCZGE2wXT1N4wfNrhxz","earliest":313},{"id":"CasrEK6bPUJAhxcQrgemiACg7BWTkgAuH8Cz7Kts4AHb","earliest":366},{"id":"CSgyKdfx4JUphvuxk2dA1xQSFPHa4apSHPn2Xf1XoxHq","earliest":352},{"id":"CSegdKYDVgGiRQakFCAgGTgamQgDFsmdfBcsfmokxr28","earliest":333},{"id":"CSaJQdWjVemtENgWW7zfRHz8YTQfHPvWnMmXndRrjPwr","earliest":398},{"id":"CSG4JjdPAk4KVa1qUA19nayuXUzWvfo51Syvq7bnuFGt","earliest":304},{"id":"CHff5HYoicGpea5CcBqLPN8dVPYDGne4C7F82SHgtBJR","earliest":230},{"id":"CCR6aqq4EyS9r6jTLxkH7Cz2286SkWThAfPQBywEYEkb","earliest":207},{"id":"CBq8nQoMoqCVnK28yDHLZEd8vtSrDtvqhKos9h9joT43","earliest":160},{"id":"CBSnJywBPCGcGeSmGHMHHuSLf9YRicbZcXhmW1uFWprt","earliest":414},{"id":"C8GXTL6hiHePb9CReY4dxxSJjedQvg1NeyvERZZyMxkF","earliest":230},{"id":"C7ScwCNAM6NmxRoAz4aJzuQ8xiofvnr1UAZRhsAw5rJF","earliest":409},{"id":"C4x8Nw1FLHiXoBnsSTEXnVsPC9a91PXLrQ3pXs9dg1i8","earliest":239},{"id":"C3nQJwRQUxQft2H2rb79yS7ZWa6wbdDkfNUBWg23Qs62","earliest":540},{"id":"BzhCdr1Cn3wuJjo2H3ot8yjpmSg6pREu6KgUx2f1vBVz","earliest":400},{"id":"BwhcxLehyeR58kHzCVtxXmCPeyYyNpdpCvkcj7KHEu9Z","earliest":400},{"id":"BoXHU8Mj8VQCSd7Ndw8dNUQ4L9GABdL9f7HJ4BCu6EAD","earliest":343},{"id":"Bbhh3BfRFTTvnYbfxRekKsZRjQdwdKrx2boxC1vjpt69","earliest":239},{"id":"BSQF9QKi1Kkis7tYkpAR6QdLfQjuTHgPzjCA5AEJqAtr","earliest":409},{"id":"BSMSWyGgX5NjAXUjM2w7SxdoNvWNCfQYQTygxzNHT1SH","earliest":263},{"id":"BRb73UhP2AQ7eMmaF7L4yx2THkEAsDFesWF5QP7VKqjt","earliest":304},{"id":"BPXqLDW53rDANKvMVFp8MbT5RLJ6FNBXRYnBFvSbxmeS","earliest":358},{"id":"BNke1mFyUmGoDVdYvtAJ5miLN949My2i5egL9ZL9BU8v","earliest":346},{"id":"BNXyyhVwzPtQg4u8TbWsarQ7uWaKqcdEh62fjqsre1Fb","earliest":349},{"id":"BEZTFWb1LULKmv2N9fm5MNJ5ELV9SzywbdQLJ6Lt4ZcQ","earliest":304},{"id":"BEUwZUBtUzz5Mu8BEetduJw3qWNN9fw1W45GMuufA6Yg","earliest":304},{"id":"BCqNtLZscny4kBB2mB3tzHrvdQsJ9ay1rkEQZsHfxQPs","earliest":263},{"id":"AzoXviS6wFH4HrGhG9PenmXr4xgN52ztapUQHfSco5he","earliest":239},{"id":"AkzA2EAFfKRkSAAEnNm8f2bnAshsSS5KNMx3CknG4W54","earliest":239},{"id":"AghMc1tj85329hgZgoGxt8jWQo2L7PSbYT8eJYqkYF4q","earliest":304},{"id":"AdDMnVY8VahHNqn52GHvowRzw2oYrTjjgJyqYiv6MTYL","earliest":207},{"id":"AaNirdH8aTA7LjMpa5AJCcJYwnKb84joEwoEMoVe8vKD","earliest":333},{"id":"AWbW8iNhu9XCNSZJXwkRM9Gk7LDgjS2tAPs5wxoioUqu","earliest":207},{"id":"AVtZ5vBJCWuz2iJFMHpVRyM5kpLNrZLp5j6UNnMW7SEq","earliest":263},{"id":"AGgVz84XTNiZ7oLefp99mXvNLKDPAf9pYgmrZkrGkxJC","earliest":283},{"id":"AFRvBiRwo8V3Nh5wuVDdFrqtfDa4vmmxWRWxqeNvtYdT","earliest":299},{"id":"AFNhfd6mG4kS6G29cXPPsPXs4gWzYEg85ecaVrXzckoS","earliest":398},{"id":"ACUeiiXQvmG15AJLTvEK7PRZGShryxXJvNVFqaAKWSn4","earliest":263},{"id":"AAXSjB1V2WWY6TPYueKWFgzuvCynyyvhgJegdK4V59bQ","earliest":179},{"id":"A4xYDSxydcgLeVUG2oQM45a3Y4rkjqxddt4XsQEGqmT1","earliest":358},{"id":"9uGdkLsK5WVpSLZ5xpWoJUh5rkL6RZpFmQa7XyW3S6GQ","earliest":325},{"id":"9SAFUf9Suumkp47nyS2SJSgfM2iyo6WRD9TFe7nVi5xh","earliest":277},{"id":"9N57qbuGUBWEweLkWRAfh9d5NpPNSuyXkbfm3VParTxv","earliest":294},{"id":"9MPSVog9n6fzGrBuRcMn9xrXHPeR9EANQnaNv2FcYxqM","earliest":179},{"id":"9MDNULHR2hESn8fMGNdgKrbpNBsdYmAD9Qbm1UWNVNhV","earliest":304},{"id":"9KpDj3nMfMhx5yW32z6kDfRYVW8wGcgq3uAiqBwFjn13","earliest":304},{"id":"9GwMxPwp4n16819JL4tZjfgRdyjjijKWNQ4m9h2GNorM","earliest":160},{"id":"9FB7737VTuzeBodS8bJ3BzvmvkwNhJ8VASLJAEU4gYVS","earliest":313},{"id":"9EypkeeHb6YBvDU4DABcZxLN6su4mKk6CuBdnAQf9oc9","earliest":361},{"id":"9BrsViMqKmQqQd988z5LRpk5hy2mc5s8Kjz7FSqAEEUK","earliest":230},{"id":"9ApnTcVtksbUQ1SUuadonmJMb8d5mCtFPFFBthATw6xZ","earliest":363},{"id":"8ymNW8NqGz6YD4pBNJMrhPWoBBhTWDkhJumTDLpdbELo","earliest":263},{"id":"8tmr7qw3G95iuoCheQiWsXWr8AMVv2cGcr5EyVsxzww8","earliest":391},{"id":"8smbZDpRBZJ9Bp7ALmsk4aXs2XAyhK3HGsHMsbJPnTzi","earliest":329},{"id":"8jWbJJA7A6RhJf5SzvS56WAcnxQ6wombVgChXz2QGrcP","earliest":333},{"id":"8fHwziverXCjCEvymZXvVj3DCPyZ1NWL6Ttjhq7N689T","earliest":263},{"id":"8A6XETxv2m3ztmajwwy7KsuELwdFRFsL8FBQoNB8PRnN","earliest":336},{"id":"7g3Bax4s1dEnUkYCocBY5CiuYPrUU4daoYxvbisaSXJa","earliest":412},{"id":"7ZmwDbedHVPD8phjfxWRCZQPJCHFnodtx7aznXZfWMrQ","earliest":329},{"id":"7NgvNANKgE55eGHPvzsmzzyxBMJRDi3BBqg1oy96jSNH","earliest":194},{"id":"7NUMSucWnTEjqkDc9b1pU1KATEvQ9PbQYkujGyaRnEaN","earliest":329},{"id":"7MvrBPYfWWgq8oxNfDpQKJ4KsgBVpDW4rKY84GJpL7jn","earliest":329},{"id":"7FLihosC2JTS7BnUcnn9k4PpMPXUirVaC3avejBUyjad","earliest":289},{"id":"77fKf5SubahPk9fdenFQ6CFsmTn7P8GLz3WZsEQt7MSC","earliest":256},{"id":"75WkZzzBu9Mi3tEWBBeV6VQ4d521MuQ8S9sFZkxh2KNY","earliest":256},{"id":"6rMd61MPK3D51gf7YF2hAQsXWo31BHXQZq1ak3oF3q45","earliest":194},{"id":"6nZoLXFH9N6wEbE9etBexgeVG6UGvyTcrLqc8pDwJ5QZ","earliest":329},{"id":"6hjYqQVBaKCNszDcmTzqUoMTKNWYQ73H9BTXNyBGSeJv","earliest":325},{"id":"6eJoQ3eJWjsdSDGbCvwdk4HU5LpH7AZyinGMka9evuWj","earliest":207},{"id":"6bJDgdRLn3hkzG8Qx1FkpGMx8ymqW9LUsj1yJBhNYVPG","earliest":333},{"id":"6ZMY76m3fVCDp4rvZF71GahuRCFWtNSijj8BxFtxQDuH","earliest":309},{"id":"6UyajL8EgzmQ8HEX9BngtU2PgLN5nhWdKbRUraFf8i2Z","earliest":387},{"id":"6RZhaWJzHKcBYw18Q7CEqCx8agbJ5MotuvXoPovCP5E6","earliest":346},{"id":"6NdT6urKaSoFoRVx1qqbLspCMJMvqcAt8GTZ7gcYuYt3","earliest":207},{"id":"6Mc41VZy1AFJYzjGaEUoz5kp53UrAUhxx328EHejqXnJ","earliest":304},{"id":"5vspr54Kn23YJBCzQWxkYa22kPVKdF88XpR1bPnJpW9U","earliest":352},{"id":"5rnptDbsG3ADGpFBCBFjniY9tkZxTcWaaaX5rxBSWQ1J","earliest":336},{"id":"5eTa2rt2qNmWrakHeN4DaSQ7Xe4cM7KvUZaLjgQtc4ng","earliest":391},{"id":"5eL6gDN3t8qqQFTV6rd32MnELj1jMjffnAeZswCnmoAL","earliest":409},{"id":"5VzWgug4zTcyvzYhdy6LHDMdwPoCbnqDukpPLKe8tSVK","earliest":358},{"id":"4rpUFgEtLcVTdGuaHQ3HuSHpwvrZBwyEZNdKVx1T5m58","earliest":333},{"id":"4rEKz2Nrsn4c5E1dQzv3i754FvND9CGkuWotWV9cegCo","earliest":355},{"id":"4r6vhNDXgr8P2icgaKa2RgNvhdAHpbCJz9UEk3LbRJMR","earliest":283},{"id":"4qkjnsg3YQxf9oe59Aqs752WhXV23uW9qbBdMLbWVzP3","earliest":230},{"id":"4WwDAQGiCbrtgAkKWuAkujy5XrqWjWzn49Y2qUHpHG6s","earliest":382},{"id":"4Sqp5syk1vNrc2UR6FmywuJ4nZZkKekn1vK4HTExBPRL","earliest":304},{"id":"4PrU5JvZJnLHoxCmQn2SfCvGT5SMbpVGUqz1JoU1GD4S","earliest":270},{"id":"49XKkGoWfyaiGdHZWzXgAFyvwwHBM5ADLuDoFpsRPMxc","earliest":283},{"id":"48W637xHRaZHDqK3EQuUfNiMUsi1EPJKaKHrCHhurbQP","earliest":317},{"id":"47c7exZyQ75WxXs8btEfAp7HviJSMo1SEfxEog2sNZfb","earliest":313},{"id":"3wTCV7PpM13kV1gLHAcsjiqyH7hYEzTWcXfg6yNuebMm","earliest":333},{"id":"3pDgTvou2uyTdjxcNdY3zpBwH4SKRQeBW8J8E3qUpWub","earliest":230},{"id":"3m3AFbWN5KwjyBdEcduGcJrJbuonhf6jBQLgtscmvty4","earliest":239},{"id":"3S49TmcNp5Vidt6UDdFmipJskfj5Gz7QBUKHwU1witZG","earliest":333},{"id":"3PrwrWQeZHaASZHG2QT1V4iHmLX4EGJGqYWCXrbFaCch","earliest":333},{"id":"3Mhhtw1MEkvzfF8vV8yY2VtGhZnjHuPQfD6FUvSuvmBR","earliest":414},{"id":"3EyHgCUcUqrPkmpYQdfY1jZHveEkRUptbD19uKVQt8AR","earliest":289},{"id":"3C1jwg9FUmoSFXedHmU7Z1cL2TAXuZJwBtqwNBhkomWt","earliest":313},{"id":"3Am2Dg8VvBjxTAPZqpN9HXy6buoyYiusDMmga5USaTQh","earliest":256},{"id":"2fYZHkxJDtFG3gC92ZZXtaF4BEMmxzidWPkmcuDHAkRv","earliest":230},{"id":"2apAzp5wDsJLdvxoa6dbrEKr3GWa1m9CV7vRjWHNEJt2","earliest":329},{"id":"29AjhvuDQzBr96zY6isUqPYuBUY7RLJvxXa4yo2dz7Qg","earliest":277},{"id":"22exqvbmjjSEtbacVjeyg5GTxjVoe17yHG6kdLz48XrW","earliest":256},{"id":"22QAibzdzuj16cHqTSTAcMLxjQkUW1fxHMYDZNfDy96c","earliest":411},{"id":"qEchNqPLrTcLqFX6dRf4djzoh2fWwV1TeSP6vMxYVwV","earliest":321},{"id":"pN2pdwtZkhKRb6zLGkmDToiJiaDXe6L58ME43b6xtB5","earliest":294},{"id":"Sa4Y2H4FcandaeYzVpTAzTcShbdjWWdwBFw9R9bTcE3","earliest":336},{"id":"Siu3HrippbWwLsobE7rC5rxciDZy1D5KYXRzU93yhkK","earliest":329},{"id":"Siggtvc4L8wvWZawxzQgVr7LSK74rRHp3vQsNXNs7yC","earliest":219},{"id":"SgbwYCL3W5tFKXgzTUgqgK3jjnrj2KRgTgikN2CtVvv","earliest":336},{"id":"PgGvfBKjZBDLF2S1qxNhC7BSPRjdhvC4CyYen69czdg","earliest":363},{"id":"NVGwEnprVVr8MKarsLHbBFu42oWhDtSxLXXaAW8X7Zo","earliest":397},{"id":"FoHdSvNVWcW4TJx2p6s6dLgZz3pMqE9UGLNST2HJTC1","earliest":452},{"id":"FVMxocW2ewz6MtdTsd4m9Xo9STtABKN8UTu8ZtfceXv","earliest":393}]
  
  const connection = new Connection(process.env.ANCHOR_PROVIDER_URL as string, 'recent');
  const metaplex = new Metaplex(connection);
  const lamportsNeeded = 10000000000;
  let authorityWallet: Keypair = Keypair.fromSecretKey(
    new Uint8Array(
      JSON.parse(
       fs.readFileSync( process.env.ANCHOR_WALLET as string ).toString(),
      ),
    ),
  );
  metaplex.use(keypairIdentity(authorityWallet));
  let fanoutSdk: FanoutClient;
    fanoutSdk = new FanoutClient(connection, new Wallet(authorityWallet));
    async function createFanout() {
      let collectionNft = await metaplex.nfts().findByMint({mintAddress:new PublicKey("DTrMWcdBCvgorNH15KLJTzxCaJc8yXHaTK51Cb4Nc45S")})
/*
        const init = await fanoutSdk.initializeFanout({
          totalShares: 757301,
          name: `Saga Genesis`,
          membershipModel: MembershipModel.NFT,
          defaultWeight: 138,
          collectionMetadata:collectionNft.metadataAddress
        });
        console.log(init.fanout.toBase58())
        console.log(init.nativeAccount.toBase58())

        */
        let failed : any[] = []
        let i = 1
        for (var nft of nfts){
          console.log(i + ' of ' + nfts.length)
          i++
          try {
        const { membershipAccount } = await fanoutSdk.addMemberNft({
          fanout: new PublicKey("ErdDj2hJr89oDMqqLQjpxs9ZEvFwSiU1D98b3sE8xzSy"),
          fanoutNativeAccount: new PublicKey("EaPhtDHz6zmqzUFhiN2rgvxywmtWkw4CWYPrpT5e6hS6"),
          membershipKey: new PublicKey(nft.id),
          shares: nft.earliest,
        });
      } catch (err){
        failed.push(nft)
        fs.writeFileSync('failed.json', JSON.stringify(failed))
        console.log(err)
      }
        }
      }
      createFanout()